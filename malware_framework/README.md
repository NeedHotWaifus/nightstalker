# Malware Framework - Advanced Red Team Simulation Platform

A production-ready, modular malware framework designed for ethical red teaming, penetration testing, and security research.

## âš ï¸ Legal Notice

**This framework is designed STRICTLY for:**
- Authorized security testing and research
- Educational purposes
- Ethical red teaming with proper authorization
- Security simulation and training

**Users are responsible for ensuring they have proper authorization before using this tool against any target. The authors are not responsible for any misuse of this software.**

## ğŸŒŸ Features

- **Modular Architecture**: Clean separation of concerns with plugin-based modules
- **Multi-Platform Support**: Windows, Linux, and macOS compatibility
- **Stealth Operations**: Advanced evasion and anti-detection capabilities
- **Multiple C2 Protocols**: TCP, HTTP/HTTPS, and Telegram integration
- **Persistence Mechanisms**: Cross-platform persistence techniques
- **Encrypted Communication**: AES/XOR encryption for all communications
- **Builder System**: Automated payload generation and obfuscation

## ğŸ—ï¸ Architecture

```
malware_framework/
â”œâ”€â”€ core/                   # Core framework components
â”‚   â”œâ”€â”€ base_payload.py    # Base payload class
â”‚   â”œâ”€â”€ c2_client.py       # C2 client base class
â”‚   â”œâ”€â”€ encryption.py      # Encryption utilities
â”‚   â”œâ”€â”€ stealth.py         # Anti-detection mechanisms
â”‚   â””â”€â”€ utils.py           # Common utilities
â”œâ”€â”€ modules/               # Payload modules
â”‚   â”œâ”€â”€ reverse_shell.py   # Reverse shell implementations
â”‚   â”œâ”€â”€ keylogger.py       # Keylogging capabilities
â”‚   â”œâ”€â”€ downloader.py      # File downloader
â”‚   â””â”€â”€ ransomware.py      # Ransomware simulator
â”œâ”€â”€ c2/                    # Command & Control
â”‚   â”œâ”€â”€ tcp_c2.py         # TCP-based C2
â”‚   â”œâ”€â”€ http_c2.py        # HTTP/HTTPS C2
â”‚   â””â”€â”€ telegram_c2.py    # Telegram bot C2
â”œâ”€â”€ persistence/           # Persistence mechanisms
â”‚   â”œâ”€â”€ windows.py        # Windows persistence
â”‚   â”œâ”€â”€ linux.py          # Linux persistence
â”‚   â””â”€â”€ macos.py          # macOS persistence
â”œâ”€â”€ utils/                 # Utility modules
â”‚   â”œâ”€â”€ obfuscation.py    # Code obfuscation
â”‚   â”œâ”€â”€ sandbox_detection.py # Anti-VM/anti-debug
â”‚   â””â”€â”€ network.py        # Network utilities
â”œâ”€â”€ config/               # Configuration files
â”‚   â”œâ”€â”€ default.yaml      # Default configuration
â”‚   â””â”€â”€ templates/        # Payload templates
â”œâ”€â”€ build/                # Output directory
â”œâ”€â”€ logs/                 # Runtime logs
â”œâ”€â”€ main.py              # Main entry point
â”œâ”€â”€ builder.py           # Payload builder
â”œâ”€â”€ requirements.txt     # Dependencies
â””â”€â”€ install.sh           # Installation script
```

## ğŸš€ Quick Start

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd malware_framework

# Run the installer
sudo ./install.sh

# Or install manually
pip install -r requirements.txt
```

### Basic Usage

```bash
# Run with interactive menu
python main.py

# Build a payload
python builder.py --type reverse_shell --target 192.168.1.100:4444

# Run specific module
python main.py --module keylogger --config config/keylogger.yaml
```

## ğŸ› ï¸ Available Modules

### Reverse Shells
- **TCP Reverse Shell**: Standard TCP-based reverse shell
- **HTTP Reverse Shell**: HTTP/HTTPS-based reverse shell
- **Encrypted Communication**: AES/XOR encryption support
- **Custom Delays**: Configurable callback intervals

### Keylogger
- **Stealth Operation**: Background keylogging
- **Configurable Dumps**: Custom log dump intervals
- **Encrypted Logs**: Optional log encryption
- **Cross-Platform**: Windows, Linux, macOS support

### Downloader
- **Remote File Retrieval**: Download files from remote sources
- **Proxy Support**: HTTP/SOCKS proxy support
- **Custom Headers**: Configurable HTTP headers
- **Resume Support**: Resume interrupted downloads

### Ransomware Simulator
- **AES Encryption**: Strong file encryption
- **Key Management**: Secure key storage
- **Decryptor Builder**: Optional decryptor generation
- **File Targeting**: Configurable file extensions

### Persistence Mechanisms
- **Windows**: Registry, Startup folder, Task Scheduler
- **Linux**: Cron jobs, .bashrc, systemd services
- **macOS**: LaunchAgents, Login Items, cron jobs

## ğŸ”§ Configuration

### Main Configuration (`config/default.yaml`)

```yaml
# Framework settings
framework:
  name: "Malware Framework"
  version: "1.0.0"
  debug: false
  stealth_mode: true

# C2 settings
c2:
  protocol: "tcp"  # tcp, http, telegram
  host: "192.168.1.100"
  port: 4444
  encryption:
    enabled: true
    algorithm: "aes"
    key: "your-secret-key"

# Stealth settings
stealth:
  sandbox_detection: true
  debugger_detection: true
  vm_detection: true
  delay_jitter: 0.3
  user_agent: "Mozilla/5.0 (compatible; Framework/1.0)"

# Persistence settings
persistence:
  enabled: true
  methods: ["registry", "startup"]
  cleanup: false

# Logging settings
logging:
  level: "INFO"
  file: "logs/framework.log"
  max_size: "10MB"
  backup_count: 5
```

## ğŸ”’ Security Features

### Anti-Detection
- **Sandbox Detection**: VM and sandbox environment detection
- **Debugger Detection**: Anti-debugging techniques
- **Process Monitoring**: Detection of analysis tools
- **Timing Analysis**: Sleep timing and execution delays

### Obfuscation
- **String Encryption**: Runtime string decryption
- **Code Obfuscation**: Basic code obfuscation
- **Import Hiding**: Dynamic import loading
- **Anti-Analysis**: Anti-disassembly techniques

### Communication Security
- **Encrypted Channels**: All C2 communication encrypted
- **Certificate Pinning**: SSL certificate validation
- **Proxy Support**: SOCKS/HTTP proxy support
- **Custom Protocols**: Custom communication protocols

## ğŸ—ï¸ Builder System

### Command Line Builder

```bash
# Build reverse shell
python builder.py --type reverse_shell --target 192.168.1.100:4444 --output shell.exe

# Build keylogger
python builder.py --type keylogger --config config/keylogger.yaml --output keylogger.exe

# Build with obfuscation
python builder.py --type reverse_shell --obfuscate --encrypt-strings --output stealth.exe

# Build for specific platform
python builder.py --type reverse_shell --platform linux --output shell
```

### Builder Features
- **Multiple Output Formats**: EXE, ELF, Mach-O
- **Obfuscation Options**: String encryption, code obfuscation
- **Icon Spoofing**: Custom icons and metadata
- **Anti-Analysis**: Anti-debugging and anti-VM features

## ğŸ“¡ C2 Protocols

### TCP C2
- **Direct Connection**: TCP socket-based communication
- **Encrypted Channel**: AES encryption for all data
- **Command Execution**: Remote command execution
- **File Transfer**: Secure file upload/download

### HTTP C2
- **Beaconing**: HTTP polling for commands
- **Encrypted Payloads**: Base64/AES encrypted data
- **Custom Headers**: Configurable HTTP headers
- **Proxy Support**: HTTP/SOCKS proxy support

### Telegram C2
- **Bot Integration**: Telegram bot-based C2
- **Encrypted Messages**: End-to-end encryption
- **File Sharing**: Secure file transfer
- **Stealth Operation**: Blend with normal traffic

## ğŸ”§ Development

### Adding New Modules

1. Create module file in `modules/`
2. Inherit from `BasePayload`
3. Implement required methods
4. Add configuration in `config/`
5. Update builder and main CLI

### Example Module

```python
from core.base_payload import BasePayload
from typing import Dict, Any

class CustomModule(BasePayload):
    """Custom payload module"""
    
    def __init__(self, config: Dict[str, Any]):
        super().__init__(config)
        self.name = "Custom Module"
    
    def execute(self) -> bool:
        """Execute the payload"""
        try:
            # Your payload logic here
            self.logger.info("Custom module executed successfully")
            return True
        except Exception as e:
            self.logger.error(f"Custom module failed: {e}")
            return False
```

## ğŸ“Š Logging and Monitoring

### Log Structure
```
logs/
â”œâ”€â”€ framework.log          # Main framework log
â”œâ”€â”€ c2_communications.log  # C2 communication log
â”œâ”€â”€ payload_execution.log  # Payload execution log
â””â”€â”€ stealth_events.log     # Stealth detection events
```

### Log Levels
- **DEBUG**: Detailed debugging information
- **INFO**: General information messages
- **WARNING**: Warning messages
- **ERROR**: Error messages
- **CRITICAL**: Critical error messages

## ğŸ³ Docker Support

### Development Environment

```bash
# Build development image
docker build -t malware-framework-dev .

# Run development container
docker run -it malware-framework-dev

# Run with volume mounting
docker run -v $(pwd):/app malware-framework-dev
```

### Production Environment

```bash
# Build production image
docker build -f Dockerfile.prod -t malware-framework .

# Run production container
docker run -d malware-framework
```

## ğŸ”§ Troubleshooting

### Common Issues

1. **Import Errors**: Ensure all dependencies are installed
2. **Permission Errors**: Run with appropriate permissions
3. **Network Issues**: Check firewall and proxy settings
4. **Detection**: Adjust stealth settings in configuration

### Debug Mode

```bash
# Enable debug mode
python main.py --debug

# Verbose logging
python main.py --verbose

# Test mode (no actual execution)
python main.py --test
```

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch
3. Add your module or enhancement
4. Write tests
5. Submit a pull request

### Development Setup

```bash
# Clone and setup development environment
git clone <repository-url>
cd malware_framework
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements-dev.txt
pre-commit install
```

## âš ï¸ Ethical Use

This framework is designed for authorized security testing only. Users must:

- Obtain proper authorization before testing
- Follow responsible disclosure practices
- Respect privacy and data protection laws
- Use only for educational and research purposes

## ğŸ†˜ Support

- **Documentation**: [docs/](docs/)
- **Issues**: [GitHub Issues](https://github.com/your-repo/malware-framework/issues)
- **Discussions**: [GitHub Discussions](https://github.com/your-repo/malware-framework/discussions)

---

**Malware Framework** - Advanced Red Team Simulation Platform  
*Professional â€¢ Modular â€¢ Stealthy* 