# Malware Framework - Advanced Red Team Simulation Platform

A production-ready, modular malware framework designed for ethical red teaming, penetration testing, and security research.

## ⚠️ Legal Notice

**This framework is designed STRICTLY for:**
- Authorized security testing and research
- Educational purposes
- Ethical red teaming with proper authorization
- Security simulation and training

**Users are responsible for ensuring they have proper authorization before using this tool against any target. The authors are not responsible for any misuse of this software.**

## 🌟 Features

- **Modular Architecture**: Clean separation of concerns with plugin-based modules
- **Multi-Platform Support**: Windows, Linux, and macOS compatibility
- **Stealth Operations**: Advanced evasion and anti-detection capabilities
- **Multiple C2 Protocols**: TCP, HTTP/HTTPS, and Telegram integration
- **Persistence Mechanisms**: Cross-platform persistence techniques
- **Encrypted Communication**: AES/XOR encryption for all communications
- **Builder System**: Automated payload generation and obfuscation

## 🏗️ Architecture

```
malware_framework/
├── core/                   # Core framework components
│   ├── base_payload.py    # Base payload class
│   ├── c2_client.py       # C2 client base class
│   ├── encryption.py      # Encryption utilities
│   ├── stealth.py         # Anti-detection mechanisms
│   └── utils.py           # Common utilities
├── modules/               # Payload modules
│   ├── reverse_shell.py   # Reverse shell implementations
│   ├── keylogger.py       # Keylogging capabilities
│   ├── downloader.py      # File downloader
│   └── ransomware.py      # Ransomware simulator
├── c2/                    # Command & Control
│   ├── tcp_c2.py         # TCP-based C2
│   ├── http_c2.py        # HTTP/HTTPS C2
│   └── telegram_c2.py    # Telegram bot C2
├── persistence/           # Persistence mechanisms
│   ├── windows.py        # Windows persistence
│   ├── linux.py          # Linux persistence
│   └── macos.py          # macOS persistence
├── utils/                 # Utility modules
│   ├── obfuscation.py    # Code obfuscation
│   ├── sandbox_detection.py # Anti-VM/anti-debug
│   └── network.py        # Network utilities
├── config/               # Configuration files
│   ├── default.yaml      # Default configuration
│   └── templates/        # Payload templates
├── build/                # Output directory
├── logs/                 # Runtime logs
├── main.py              # Main entry point
├── builder.py           # Payload builder
├── requirements.txt     # Dependencies
└── install.sh           # Installation script
```

## 🚀 Quick Start

### Installation

```bash
# Clone the repository
git clone <repository-url>
cd malware_framework

# Run the installer
sudo ./install.sh

# Or install manually
pip install -r requirements.txt
```

### Basic Usage

```bash
# Run with interactive menu
python main.py

# Build a payload
python builder.py --type reverse_shell --target 192.168.1.100:4444

# Run specific module
python main.py --module keylogger --config config/keylogger.yaml
```

## 🛠️ Available Modules

### Reverse Shells
- **TCP Reverse Shell**: Standard TCP-based reverse shell
- **HTTP Reverse Shell**: HTTP/HTTPS-based reverse shell
- **Encrypted Communication**: AES/XOR encryption support
- **Custom Delays**: Configurable callback intervals

### Keylogger
- **Stealth Operation**: Background keylogging
- **Configurable Dumps**: Custom log dump intervals
- **Encrypted Logs**: Optional log encryption
- **Cross-Platform**: Windows, Linux, macOS support

### Downloader
- **Remote File Retrieval**: Download files from remote sources
- **Proxy Support**: HTTP/SOCKS proxy support
- **Custom Headers**: Configurable HTTP headers
- **Resume Support**: Resume interrupted downloads

### Ransomware Simulator
- **AES Encryption**: Strong file encryption
- **Key Management**: Secure key storage
- **Decryptor Builder**: Optional decryptor generation
- **File Targeting**: Configurable file extensions

### Persistence Mechanisms
- **Windows**: Registry, Startup folder, Task Scheduler
- **Linux**: Cron jobs, .bashrc, systemd services
- **macOS**: LaunchAgents, Login Items, cron jobs

## 🔧 Configuration

### Main Configuration (`config/default.yaml`)

```yaml
# Framework settings
framework:
  name: "Malware Framework"
  version: "1.0.0"
  debug: false
  stealth_mode: true

# C2 settings
c2:
  protocol: "tcp"  # tcp, http, telegram
  host: "192.168.1.100"
  port: 4444
  encryption:
    enabled: true
    algorithm: "aes"
    key: "your-secret-key"

# Stealth settings
stealth:
  sandbox_detection: true
  debugger_detection: true
  vm_detection: true
  delay_jitter: 0.3
  user_agent: "Mozilla/5.0 (compatible; Framework/1.0)"

# Persistence settings
persistence:
  enabled: true
  methods: ["registry", "startup"]
  cleanup: false

# Logging settings
logging:
  level: "INFO"
  file: "logs/framework.log"
  max_size: "10MB"
  backup_count: 5
```

## 🔒 Security Features

### Anti-Detection
- **Sandbox Detection**: VM and sandbox environment detection
- **Debugger Detection**: Anti-debugging techniques
- **Process Monitoring**: Detection of analysis tools
- **Timing Analysis**: Sleep timing and execution delays

### Obfuscation
- **String Encryption**: Runtime string decryption
- **Code Obfuscation**: Basic code obfuscation
- **Import Hiding**: Dynamic import loading
- **Anti-Analysis**: Anti-disassembly techniques

### Communication Security
- **Encrypted Channels**: All C2 communication encrypted
- **Certificate Pinning**: SSL certificate validation
- **Proxy Support**: SOCKS/HTTP proxy support
- **Custom Protocols**: Custom communication protocols

## 🏗️ Builder System

### Command Line Builder

```bash
# Build reverse shell
python builder.py --type reverse_shell --target 192.168.1.100:4444 --output shell.exe

# Build keylogger
python builder.py --type keylogger --config config/keylogger.yaml --output keylogger.exe

# Build with obfuscation
python builder.py --type reverse_shell --obfuscate --encrypt-strings --output stealth.exe

# Build for specific platform
python builder.py --type reverse_shell --platform linux --output shell
```

### Builder Features
- **Multiple Output Formats**: EXE, ELF, Mach-O
- **Obfuscation Options**: String encryption, code obfuscation
- **Icon Spoofing**: Custom icons and metadata
- **Anti-Analysis**: Anti-debugging and anti-VM features

## 📡 C2 Protocols

### TCP C2
- **Direct Connection**: TCP socket-based communication
- **Encrypted Channel**: AES encryption for all data
- **Command Execution**: Remote command execution
- **File Transfer**: Secure file upload/download

### HTTP C2
- **Beaconing**: HTTP polling for commands
- **Encrypted Payloads**: Base64/AES encrypted data
- **Custom Headers**: Configurable HTTP headers
- **Proxy Support**: HTTP/SOCKS proxy support

### Telegram C2
- **Bot Integration**: Telegram bot-based C2
- **Encrypted Messages**: End-to-end encryption
- **File Sharing**: Secure file transfer
- **Stealth Operation**: Blend with normal traffic

## 🔧 Development

### Adding New Modules

1. Create module file in `modules/`
2. Inherit from `BasePayload`
3. Implement required methods
4. Add configuration in `config/`
5. Update builder and main CLI

### Example Module

```python
from core.base_payload import BasePayload
from typing import Dict, Any

class CustomModule(BasePayload):
    """Custom payload module"""
    
    def __init__(self, config: Dict[str, Any]):
        super().__init__(config)
        self.name = "Custom Module"
    
    def execute(self) -> bool:
        """Execute the payload"""
        try:
            # Your payload logic here
            self.logger.info("Custom module executed successfully")
            return True
        except Exception as e:
            self.logger.error(f"Custom module failed: {e}")
            return False
```

## 📊 Logging and Monitoring

### Log Structure
```
logs/
├── framework.log          # Main framework log
├── c2_communications.log  # C2 communication log
├── payload_execution.log  # Payload execution log
└── stealth_events.log     # Stealth detection events
```

### Log Levels
- **DEBUG**: Detailed debugging information
- **INFO**: General information messages
- **WARNING**: Warning messages
- **ERROR**: Error messages
- **CRITICAL**: Critical error messages

## 🐳 Docker Support

### Development Environment

```bash
# Build development image
docker build -t malware-framework-dev .

# Run development container
docker run -it malware-framework-dev

# Run with volume mounting
docker run -v $(pwd):/app malware-framework-dev
```

### Production Environment

```bash
# Build production image
docker build -f Dockerfile.prod -t malware-framework .

# Run production container
docker run -d malware-framework
```

## 🔧 Troubleshooting

### Common Issues

1. **Import Errors**: Ensure all dependencies are installed
2. **Permission Errors**: Run with appropriate permissions
3. **Network Issues**: Check firewall and proxy settings
4. **Detection**: Adjust stealth settings in configuration

### Debug Mode

```bash
# Enable debug mode
python main.py --debug

# Verbose logging
python main.py --verbose

# Test mode (no actual execution)
python main.py --test
```

## 📝 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Add your module or enhancement
4. Write tests
5. Submit a pull request

### Development Setup

```bash
# Clone and setup development environment
git clone <repository-url>
cd malware_framework
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements-dev.txt
pre-commit install
```

## ⚠️ Ethical Use

This framework is designed for authorized security testing only. Users must:

- Obtain proper authorization before testing
- Follow responsible disclosure practices
- Respect privacy and data protection laws
- Use only for educational and research purposes

## 🆘 Support

- **Documentation**: [docs/](docs/)
- **Issues**: [GitHub Issues](https://github.com/your-repo/malware-framework/issues)
- **Discussions**: [GitHub Discussions](https://github.com/your-repo/malware-framework/discussions)

---

**Malware Framework** - Advanced Red Team Simulation Platform  
*Professional • Modular • Stealthy* 