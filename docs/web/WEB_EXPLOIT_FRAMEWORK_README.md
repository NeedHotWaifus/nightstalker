# 🌙 NightStalker Web Exploitation Framework

A comprehensive, modular web exploitation framework that integrates with NightStalker's advanced offensive security capabilities. This framework provides automated installation of essential web penetration testing tools and a clean interface for conducting web security assessments.

## 🚀 Features

### 🧰 **Included Tools**
- **Network Tools**: nc (netcat) for manual network interaction
- **Exploitation**: Metasploit Framework for advanced exploitation and post-exploitation
- **Web Testing**: sqlmap, wpscan, nikto, dirsearch, nuclei, ffuf, httpx
- **Bruteforce**: OpenBullet 2 for credential stuffing and configuration-based testing
- **Proxy/Tunnel**: proxychains, ngrok for secure tunneling
- **Additional**: Burp Suite Community Edition integration

### 🧩 **Modular Architecture**
```
/modules/
├── recon/          # Reconnaissance and enumeration
├── exploit/        # Vulnerability exploitation
├── bruteforce/     # Password and credential testing
├── post/           # Post-exploitation activities
└── auxiliary/      # Supporting tools and utilities
```

### 🔧 **Automated Setup**
- **Cross-platform installer** supporting Kali/Parrot, Ubuntu/Debian, and macOS
- **Dependency management** with automatic tool detection and installation
- **Wrapper scripts** for easy tool access
- **Configuration management** with persistent settings

### 🧠 **Smart Features**
- **Auto-detection** of installed tools with missing tool warnings
- **Structured loot organization** per target with logs, outputs, and screenshots
- **Tunneling support** with SSH/Ngrok and proxychains configuration
- **Docker integration** for tools like OpenBullet and Metasploit
- **Rich TUI interface** with categorized modules and progress tracking

## 📦 Installation

### Quick Install
```bash
# Clone the repository
git clone https://github.com/your-repo/nightstalker-web-exploit.git
cd nightstalker-web-exploit

# Run automated installer
python3 install_web_exploit_framework.py

# Or with specific options
python3 install_web_exploit_framework.py --verbose --skip-docker
```

### Manual Installation
```bash
# Install system dependencies
sudo apt-get update
sudo apt-get install -y git curl wget python3 python3-pip build-essential

# Install Python dependencies
pip3 install requests beautifulsoup4 lxml selenium paramiko cryptography

# Install Go (for Go-based tools)
wget https://go.dev/dl/go1.21.0.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.21.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc

# Install Docker (for containerized tools)
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# Install Ruby and gems
sudo apt-get install -y ruby ruby-dev
gem install wpscan

# Install Metasploit Framework
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb > msfinstall
chmod +x msfinstall
sudo ./msfinstall
```

## 🎯 Usage

### Command Line Interface

#### Basic Framework Usage
```bash
# Initialize framework
python3 -c "
from nightstalker.redteam.web_exploit_framework import NightStalkerWebExploitFramework
framework = NightStalkerWebExploitFramework()
"

# Set target
framework.set_target("https://target.com")

# Run reconnaissance
results = framework.run_reconnaissance("https://target.com")

# Run exploitation
results = framework.run_exploitation("https://target.com")

# Run bruteforce
results = framework.run_bruteforce("https://target.com")

# Generate report
report_path = framework.generate_report("https://target.com")
```

#### Tool Management
```bash
# Check tool status
status_report = framework.get_tool_status_report()

# Install missing tools
framework.install_all_tools()

# Install specific tool
framework.install_tool("sqlmap")

# Run specific tool
success, output = framework.run_tool("nuclei", ["-u", "https://target.com"])
```

### Text User Interface (TUI)

#### Launch TUI
```bash
# Launch Rich-based TUI (recommended)
python3 -m nightstalker.redteam.web_exploit_tui

# Or run directly
python3 nightstalker/redteam/web_exploit_tui.py
```

#### TUI Features
- **Target Management**: Set and manage targets
- **Module Categories**: Reconnaissance, Exploitation, Bruteforce, Post-Exploitation
- **Tool Status**: Real-time tool availability checking
- **Progress Tracking**: Live progress updates for long-running operations
- **Report Generation**: Integrated reporting with HTML output

### Integration with NightStalker CLI

#### Web Red Teaming Commands
```bash
# Comprehensive web scan
python -m nightstalker.cli webred scan --url https://target.com --modules all --output scan.json

# Exploitation with post-exploitation
python -m nightstalker.cli webred exploit --url https://target.com --exploit sqlmap --post-exploit

# Post-exploitation activities
python -m nightstalker.cli webred post-exploit --target-info scan.json --gain-root --exfil-data

# Trace clearing
python -m nightstalker.cli webred clear-traces --target-info exploit.json --aggressive

# Report generation
python -m nightstalker.cli webred report --input results.json --output report.html
```

## 🛠️ Tool Categories

### Reconnaissance Tools
- **nuclei**: Fast vulnerability scanner
- **nikto**: Web server scanner
- **dirsearch**: Web path scanner
- **httpx**: HTTP toolkit
- **wpscan**: WordPress security scanner
- **subfinder**: Subdomain discovery

### Exploitation Tools
- **sqlmap**: Automated SQL injection
- **msfconsole**: Metasploit Framework
- **nuclei**: Vulnerability exploitation

### Bruteforce Tools
- **OpenBullet 2**: Configuration-based testing
- **hydra**: Network login cracker

### Post-Exploitation Tools
- **msfconsole**: Post-exploitation modules
- **nc**: Manual network interaction

### Auxiliary Tools
- **proxychains**: Proxy chain tool
- **ngrok**: Secure tunnels
- **burpsuite**: Web application security testing

## 📁 Directory Structure

```
nightstalker_web/
├── framework/              # Framework core files
├── modules/                # Module categories
│   ├── recon/             # Reconnaissance modules
│   ├── exploit/           # Exploitation modules
│   ├── bruteforce/        # Bruteforce modules
│   ├── post/              # Post-exploitation modules
│   └── auxiliary/         # Auxiliary modules
├── tools/                  # Installed tools
│   ├── OpenBullet2/       # OpenBullet 2
│   ├── nuclei-templates/  # Nuclei templates
│   └── seclists/          # Security lists
├── loot/                   # Target-specific results
│   └── target.com/
│       ├── recon/         # Reconnaissance results
│       ├── exploit/       # Exploitation results
│       ├── bruteforce/    # Bruteforce results
│       ├── post/          # Post-exploitation results
│       ├── screenshots/   # Screenshots
│       └── logs/          # Log files
├── bin/                    # Wrapper scripts
├── config.json            # Framework configuration
├── install.log            # Installation log
└── install_status.json    # Installation status
```

## 🔧 Configuration

### Framework Configuration
```json
{
  "framework": {
    "version": "1.0.0",
    "base_dir": "/path/to/framework",
    "install_date": 1234567890
  },
  "system": {
    "os": "linux",
    "distro": "kali",
    "package_manager": "apt"
  },
  "tools": {
    "installed": ["sqlmap", "nuclei", "nikto"],
    "failed": []
  },
  "settings": {
    "auto_update": true,
    "docker_enabled": true,
    "proxy_enabled": false,
    "tunnel_enabled": false
  }
}
```

### Proxy Configuration
```bash
# Setup proxy
python3 -c "
from nightstalker.redteam.web_exploit_framework import NightStalkerWebExploitFramework
framework = NightStalkerWebExploitFramework()
framework.setup_proxy('socks5', '127.0.0.1', '9050')
"
```

### Tunnel Configuration
```bash
# Setup tunnel
python3 -c "
from nightstalker.redteam.web_exploit_framework import NightStalkerWebExploitFramework
framework = NightStalkerWebExploitFramework()
framework.setup_tunnel('ngrok', 8080)
"
```

## 📊 Reporting

### HTML Report Features
- **Executive Summary**: High-level findings and recommendations
- **Technical Details**: Detailed technical analysis
- **Vulnerabilities**: Identified vulnerabilities with severity ratings
- **Exploitation**: Successful exploitation techniques
- **Post-Exploitation**: Activities performed after initial access
- **Timeline**: Chronological attack timeline
- **Evidence**: Collected evidence and artifacts

### Report Generation
```python
# Generate comprehensive report
report_path = framework.generate_report("https://target.com")

# Generate integrated report (with NightStalker)
results = framework.run_comprehensive_assessment("https://target.com")
report_path = framework.generate_integrated_report("https://target.com", results)
```

## 🔒 Security Considerations

### Authorization
- **Only use on authorized targets**
- Obtain proper written permission
- Follow responsible disclosure practices
- Respect scope limitations

### Legal Compliance
- Ensure compliance with local laws
- Follow ethical hacking guidelines
- Maintain proper documentation
- Report findings responsibly

### Operational Security
- Use secure communication channels
- Implement proper logging
- Maintain evidence integrity
- Follow chain of custody procedures

## 🐛 Troubleshooting

### Common Issues

#### Import Errors
```bash
# Ensure proper module installation
pip3 install -r requirements.txt
python3 -m nightstalker.cli --help
```

#### Permission Errors
```bash
# Run with appropriate permissions
sudo python3 install_web_exploit_framework.py
```

#### Tool Installation Failures
```bash
# Check system dependencies
sudo apt-get update
sudo apt-get install -y build-essential libssl-dev libffi-dev

# Reinstall specific tool
framework.install_tool("sqlmap")
```

#### Docker Issues
```bash
# Ensure Docker is running
sudo systemctl start docker
sudo usermod -aG docker $USER
```

### Debug Mode
```bash
# Enable debug logging
export NIGHTSTALKER_DEBUG=1
python3 -m nightstalker.cli webred scan --url https://target.com
```

## 🔄 Updates and Maintenance

### Framework Updates
```bash
# Update framework components
git pull origin main
python3 install_web_exploit_framework.py --update-only
```

### Tool Updates
```bash
# Update specific tools
framework.install_tool("sqlmap")  # Reinstall to update
framework.install_tool("nuclei")  # Reinstall to update
```

### Configuration Backup
```bash
# Backup configuration
cp config.json config.json.backup

# Restore configuration
cp config.json.backup config.json
```

## 🤝 Integration

### With NightStalker Framework
The Web Exploitation Framework is fully integrated with NightStalker's existing capabilities:

```python
# Use with NightStalker web red teaming
from nightstalker.redteam.web_exploit_framework import NightStalkerWebExploitFramework
from nightstalker.redteam.webred import WebRedTeam

# Initialize both frameworks
web_exploit = NightStalkerWebExploitFramework()
webred = WebRedTeam()

# Run comprehensive assessment
results = web_exploit.run_comprehensive_assessment("https://target.com")
```

### With External Tools
```bash
# Use with external tools
export PATH=$PATH:/path/to/framework/bin
web-exploit scan https://target.com
```

## 📚 Examples

### Complete Workflow Example
```python
from nightstalker.redteam.web_exploit_framework import NightStalkerWebExploitFramework

# Initialize framework
framework = NightStalkerWebExploitFramework()

# Set target
framework.set_target("https://target.com")

# Phase 1: Reconnaissance
recon_results = framework.run_reconnaissance("https://target.com")

# Phase 2: Exploitation
exploit_results = framework.run_exploitation("https://target.com")

# Phase 3: Post-Exploitation
post_results = framework.run_post_exploitation("https://target.com")

# Phase 4: Report Generation
report_path = framework.generate_report("https://target.com")

print(f"Assessment complete. Report: {report_path}")
```

### Custom Tool Integration
```python
# Add custom tool
custom_tool = {
    "name": "CustomScanner",
    "command": "custom_scanner",
    "install_command": "pip3 install custom-scanner",
    "check_command": "which custom_scanner",
    "description": "Custom web scanner",
    "category": "recon"
}

framework.tools["custom_scanner"] = custom_tool
```

## 📄 License

This project is licensed under the MIT License - see the LICENSE file for details.

## ⚠️ Disclaimer

This framework is designed for authorized security testing and educational purposes only. Users are responsible for ensuring they have proper authorization before testing any systems. The authors are not responsible for any misuse of this framework.

## 🤝 Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

### Development Setup
```bash
# Clone repository
git clone https://github.com/your-repo/nightstalker-web-exploit.git
cd nightstalker-web-exploit

# Install development dependencies
pip3 install -r requirements-dev.txt

# Run tests
python3 -m pytest tests/

# Run linting
python3 -m flake8 nightstalker/
```

## 📞 Support

- **Documentation**: [WEB_RED_TEAMING_GUIDE.md](WEB_RED_TEAMING_GUIDE.md)
- **Issues**: [GitHub Issues](https://github.com/your-repo/nightstalker-web-exploit/issues)
- **Discussions**: [GitHub Discussions](https://github.com/your-repo/nightstalker-web-exploit/discussions)

---

**Remember**: Always obtain proper authorization before testing any web application, and follow responsible disclosure practices when reporting vulnerabilities. 